import{f as m,a as o,c as Z,t as $}from"../chunks/BAToY3dM.js";import{o as Mt}from"../chunks/tgyn-xxr.js";import{p as Tt,s as N,a as Et,d as r,e as s,c as i,t as K,b as Xt,r as e,g as a,f as C,u as jt}from"../chunks/fsS-m6VO.js";import{d as zt,s as x}from"../chunks/DKvjqhBm.js";import{i as L}from"../chunks/DGklRumq.js";import{e as vt,i as ct}from"../chunks/BzWd8bhm.js";import{s as _}from"../chunks/DOhhwrM8.js";var Bt=m('<div class="flex justify-center p-8"><span class="loading loading-spinner loading-lg"></span></div>'),wt=m('<div class="alert alert-error" role="alert" aria-live="assertive"><span> </span></div>'),Ot=m('<div class="card bg-base-200"><div class="card-body text-center"><p class="text-base-content/60">No alerts recorded</p></div></div>'),Ht=m("<div></div>"),Pt=m('<tr><td><div class="text-sm"> </div> <div class="text-xs text-base-content/50"> </div></td><td><span> </span></td><td> </td><td><div class="flex items-center gap-1"></div></td><td><!></td></tr>'),Ut=m('<div class="overflow-x-auto"><table class="table table-zebra"><thead><tr><th>Time</th><th>Band</th><th>Frequency</th><th>Strength</th><th>Direction</th></tr></thead><tbody></tbody></table></div> <div class="text-sm text-base-content/50 text-center"> </div>',1),Gt=m('<div class="space-y-4"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold">Alert Log</h1> <div class="flex gap-2"><button class="btn btn-sm btn-outline">üîÑ Refresh</button> <button class="btn btn-sm btn-error btn-outline">üóëÔ∏è Clear</button></div></div> <div class="tabs tabs-boxed bg-base-200"><button>All</button> <button>Ka</button> <button>K</button> <button>X</button> <button>Laser</button></div> <!></div>');function $t(bt,ft){Tt(ft,!0);let y=N(Et([])),D=N(!0),g=N(null),l=N("all");Mt(async()=>{await tt()});async function tt(){i(D,!0);try{const t=await fetch("/api/alerts");if(t.ok){const d=await t.json(),A=Array.isArray(d)?d:d.alerts||[];i(y,A.map(S=>ht(S)),!0),i(g,null)}else i(g,"Failed to load alerts")}catch{i(g,"Connection error")}finally{i(D,!1)}}async function ut(){if(confirm("Clear all alerts from the log?"))try{await fetch("/api/alerts/clear",{method:"POST"}),i(y,[],!0)}catch{i(g,"Failed to clear")}}function _t(t){switch(t){case"Ka":return"badge-error";case"K":return"badge-warning";case"X":return"badge-info";case"LASER":return"badge-secondary";default:return"badge-ghost"}}function mt(t){return t?new Date(t*1e3).toLocaleTimeString():""}function gt(t){return t?new Date(t*1e3).toLocaleDateString():""}function ht(t){const d=t.band||t.Band||"",A=Number(t.freq||t.frequency||0),S=Number(t.front||t.frontStrength||0),O=Number(t.rear||t.rearStrength||0),c=Math.max(S,O),n=(t.dir||t.direction||"").toString().toUpperCase();let b=2;n==="F"||n==="FRONT"||n==="0"?b=0:(n==="R"||n==="REAR"||n==="1")&&(b=1);const k=Number(t.ts||t.ms||0),H=Math.floor(k/1e3);return{band:d,frequency:A,strength:c,direction:b,timestamp:H}}let M=jt(()=>a(l)==="all"?a(y):a(y).filter(t=>t.band===a(l)));var T=Gt(),E=r(T),at=s(r(E),2),et=r(at);et.__click=tt;var pt=s(et,2);pt.__click=ut,e(at),e(E);var X=s(E,2),j=r(X);j.__click=()=>i(l,"all");var z=s(j,2);z.__click=()=>i(l,"Ka");var B=s(z,2);B.__click=()=>i(l,"K");var w=s(B,2);w.__click=()=>i(l,"X");var rt=s(w,2);rt.__click=()=>i(l,"LASER"),e(X);var xt=s(X,2);{var yt=t=>{var d=Bt();o(t,d)},At=t=>{var d=Z(),A=C(d);{var S=c=>{var n=wt(),b=r(n),k=r(b,!0);e(b),e(n),K(()=>x(k,a(g))),o(c,n)},O=c=>{var n=Z(),b=C(n);{var k=h=>{var q=Ot();o(h,q)},H=h=>{var q=Ut(),P=C(q),st=r(P),nt=s(r(st));vt(nt,21,()=>a(M),ct,(kt,f)=>{var U=Pt(),G=r(U),I=r(G),Rt=r(I,!0);e(I);var it=s(I,2),Kt=r(it,!0);e(it),e(G);var J=s(G),Q=r(J),Lt=r(Q,!0);e(Q),e(J);var V=s(J),qt=r(V);e(V);var W=s(V),lt=r(W);vt(lt,20,()=>Array(8),ct,(v,u,R)=>{var F=Ht();K(()=>_(F,1,`w-2 h-4 rounded ${R<a(f).strength?"bg-primary":"bg-base-300"}`)),o(v,F)}),e(lt),e(W);var dt=s(W),Ft=r(dt);{var Nt=v=>{var u=$("‚¨ÜÔ∏è Front");o(v,u)},Ct=v=>{var u=Z(),R=C(u);{var F=p=>{var Y=$("‚¨áÔ∏è Rear");o(p,Y)},Dt=p=>{var Y=$("‚ÜîÔ∏è Side");o(p,Y)};L(R,p=>{a(f).direction===1?p(F):p(Dt,!1)},!0)}o(v,u)};L(Ft,v=>{a(f).direction===0?v(Nt):v(Ct,!1)})}e(dt),e(U),K((v,u,R)=>{x(Rt,v),x(Kt,u),_(Q,1,`badge ${R??""}`),x(Lt,a(f).band),x(qt,`${a(f).frequency??""} MHz`)},[()=>mt(a(f).timestamp),()=>gt(a(f).timestamp),()=>_t(a(f).band)]),o(kt,U)}),e(nt),e(st),e(P);var ot=s(P,2),St=r(ot);e(ot),K(()=>x(St,`Showing ${a(M).length??""} of ${a(y).length??""} alerts`)),o(h,q)};L(b,h=>{a(M).length===0?h(k):h(H,!1)},!0)}o(c,n)};L(A,c=>{a(g)?c(S):c(O,!1)},!0)}o(t,d)};L(xt,t=>{a(D)?t(yt):t(At,!1)})}e(T),K(()=>{_(j,1,`tab ${a(l)==="all"?"tab-active":""}`),_(z,1,`tab ${a(l)==="Ka"?"tab-active":""}`),_(B,1,`tab ${a(l)==="K"?"tab-active":""}`),_(w,1,`tab ${a(l)==="X"?"tab-active":""}`),_(rt,1,`tab ${a(l)==="LASER"?"tab-active":""}`)}),o(bt,T),Xt()}zt(["click"]);export{$t as component};
