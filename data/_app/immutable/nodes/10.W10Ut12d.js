import{f as b,a as m}from"../chunks/BAToY3dM.js";import{o as ba}from"../chunks/tgyn-xxr.js";import{p as ua,s as f,a as ga,b as _a,e as o,d as t,g as r,r as e,c as s,t as X,f as Z,n as T}from"../chunks/fsS-m6VO.js";import{d as wa,s as aa}from"../chunks/DKvjqhBm.js";import{i as S}from"../chunks/DGklRumq.js";import{e as ya,i as ha}from"../chunks/BzWd8bhm.js";import{r as E,s as _}from"../chunks/DtA2OqT-.js";import{s as xa}from"../chunks/DOhhwrM8.js";import{a as Ta,b as sa}from"../chunks/DQHpviRV.js";var Sa=b('<div role="status" aria-live="polite"> </div>'),Fa=b('<div class="flex justify-center py-12"><span class="loading loading-spinner loading-lg text-cyan-400"></span></div>'),ka=b('<div class="divider text-sm text-base-content/50"></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-control"><label class="label"><span class="label-text">SSID</span></label> <input type="text" class="input input-bordered"/></div> <div class="form-control"><label class="label"><span class="label-text">Password</span></label> <input type="password" class="input input-bordered" placeholder="Password"/></div></div>',1),Na=b('<span class="loading loading-spinner loading-sm"></span>'),Da=b('<span class="loading loading-spinner loading-sm"></span>'),Pa=b(`<div class="card bg-base-200"><div class="card-body"><h2 class="card-title text-lg">Current Time (UTC)</h2> <div class="flex justify-between items-center py-2"><span class="text-base-content/60">System Time</span> <span class="font-mono text-lg"> </span></div> <p class="text-sm text-base-content/50">All times displayed and stored in UTC. Configure NTP sync or set manually for accurate timestamps.</p></div></div> <div class="card bg-base-200"><div class="card-body"><h2 class="card-title text-lg">WiFi Networks for Internet/NTP</h2> <p class="text-sm text-base-content/50 mb-4">Add up to 3 WiFi networks. The device will automatically connect to whichever is available with the strongest signal.</p> <div class="form-control mb-4"><label class="label cursor-pointer justify-start gap-4"><input type="checkbox" class="toggle toggle-primary"/> <span class="label-text">Enable WiFi STA mode (for NTP sync & NAT routing)</span></label></div> <!> <div class="card-actions justify-end mt-4"><button class="btn btn-primary"><!> Save WiFi Settings</button></div></div></div> <div class="card bg-base-200"><div class="card-body"><h2 class="card-title text-lg">Manual Time Setting</h2> <p class="text-sm text-base-content/50 mb-4">Set time manually if you don't want to connect to WiFi. Your device will use this time.</p> <button class="btn btn-secondary"><!> Set Time from This Device</button></div></div>`,1),Wa=b('<div class="space-y-6"><h1 class="text-2xl font-bold text-cyan-400">Time Settings</h1> <!> <!></div>');function Ua(ta,ea){ua(ea,!0);let A=f("Loading..."),w=f(!1),F=f(ga([{ssid:"",password:""},{ssid:"",password:""},{ssid:"",password:""}])),k=f(!0),c=f(!1),n=f(""),u=f("");async function N(){s(k,!0);try{const a=await fetch("/api/timesettings");if(!a.ok)throw new Error("Failed to load");const i=await a.json();s(A,i.currentTime||"Not Set",!0),s(w,i.enableTimesync||!1,!0),s(F,i.wifiNetworks||[{ssid:"",password:""},{ssid:"",password:""},{ssid:"",password:""}],!0)}catch{s(n,"Failed to load settings"),s(u,"error")}finally{s(k,!1)}}async function ia(){s(c,!0),s(n,"");try{const a=new FormData;if(r(w)&&a.append("enableTimesync","on"),r(F).forEach((d,g)=>{a.append(`wifi${g}ssid`,d.ssid),a.append(`wifi${g}pwd`,d.password)}),(await fetch("/time",{method:"POST",body:a})).ok)s(n,"Settings saved!"),s(u,"success"),await N();else throw new Error("Save failed")}catch{s(n,"Failed to save settings"),s(u,"error")}finally{s(c,!1)}}async function ra(){s(c,!0),s(n,"");try{const a=Math.floor(Date.now()/1e3),i=new FormData;if(i.append("timestamp",a.toString()),(await fetch("/time",{method:"POST",body:i})).ok)s(n,"Time set from this device!"),s(u,"success"),await N();else throw new Error("Failed to set time")}catch{s(n,"Failed to set time"),s(u,"error")}finally{s(c,!1)}}ba(()=>{N()});var D=Wa(),H=o(t(D),2);{var oa=a=>{var i=Sa(),d=t(i,!0);e(i),X(()=>{xa(i,1,`alert ${r(u)==="success"?"alert-success":"alert-error"}`),aa(d,r(n))}),m(a,i)};S(H,a=>{r(n)&&a(oa)})}var la=o(H,2);{var na=a=>{var i=Fa();m(a,i)},da=a=>{var i=Pa(),d=Z(i),g=t(d),M=o(t(g),2),I=o(t(M),2),ca=t(I,!0);e(I),e(M),T(2),e(g),e(d);var P=o(d,2),O=t(P),W=o(t(O),4),U=t(W),L=t(U);E(L),T(2),e(U),e(W);var Y=o(W,2);ya(Y,17,()=>r(F),ha,(l,v,p)=>{var G=ka(),J=Z(G);J.textContent=`Network ${p+1}`;var K=o(J,2),C=t(K),Q=t(C);_(Q,"for",`wifi${p}ssid`);var x=o(Q,2);E(x),_(x,"id",`wifi${p}ssid`),_(x,"placeholder",p===0?"e.g., Home WiFi":p===1?"e.g., Car WiFi Hotspot":"e.g., Phone Hotspot"),e(C);var R=o(C,2),V=t(R);_(V,"for",`wifi${p}pwd`);var $=o(V,2);E($),_($,"id",`wifi${p}pwd`),e(R),e(K),sa(x,()=>r(v).ssid,j=>r(v).ssid=j),sa($,()=>r(v).password,j=>r(v).password=j),m(l,G)});var q=o(Y,2),y=t(q);y.__click=ia;var va=t(y);{var pa=l=>{var v=Na();m(l,v)};S(va,l=>{r(c)&&l(pa)})}T(),e(y),e(q),e(O),e(P);var z=o(P,2),B=t(z),h=o(t(B),4);h.__click=ra;var ma=t(h);{var fa=l=>{var v=Da();m(l,v)};S(ma,l=>{r(c)&&l(fa)})}T(),e(h),e(B),e(z),X(()=>{aa(ca,r(A)),y.disabled=r(c),h.disabled=r(c)}),Ta(L,()=>r(w),l=>s(w,l)),m(a,i)};S(la,a=>{r(k)?a(na):a(da,!1)})}e(D),m(ta,D),_a()}wa(["click"]);export{Ua as component};
