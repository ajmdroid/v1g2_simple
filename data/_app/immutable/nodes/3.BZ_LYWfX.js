import{f as m,a as i,c as Y,t as Z}from"../chunks/BAToY3dM.js";import{o as Et}from"../chunks/tgyn-xxr.js";import{p as Tt,s as q,a as Mt,d as r,e as n,c as l,t as K,b as Xt,r as e,g as a,f as z,u as jt}from"../chunks/fsS-m6VO.js";import{d as Bt,s as A}from"../chunks/DKvjqhBm.js";import{i as L}from"../chunks/DGklRumq.js";import{e as ct,i as dt}from"../chunks/BzWd8bhm.js";import{s as _}from"../chunks/DOhhwrM8.js";var Ht=m('<div class="flex justify-center p-8"><span class="loading loading-spinner loading-lg"></span></div>'),Ot=m('<div class="alert alert-error" role="alert" aria-live="assertive"><span> </span></div>'),wt=m('<div class="card bg-base-200"><div class="card-body text-center"><p class="text-base-content/60">No alerts recorded</p></div></div>'),Gt=m("<div></div>"),Pt=m('<tr><td><div class="text-sm"> </div> <div class="text-xs text-base-content/50"> </div></td><td><span> </span></td><td> </td><td><div class="flex items-center gap-1"></div></td><td><!></td></tr>'),Ut=m('<div class="overflow-x-auto"><table class="table table-zebra"><thead><tr><th>Time</th><th>Band</th><th>Frequency</th><th>Strength</th><th>Direction</th></tr></thead><tbody></tbody></table></div> <div class="text-sm text-base-content/50 text-center"> </div>',1),It=m('<div class="space-y-4"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold">Alert Log</h1> <div class="flex gap-2"><button class="btn btn-sm btn-outline">üîÑ Refresh</button> <button class="btn btn-sm btn-error btn-outline">üóëÔ∏è Clear</button></div></div> <div class="tabs tabs-boxed bg-base-200"><button>All</button> <button>Ka</button> <button>K</button> <button>X</button> <button>Laser</button></div> <!></div>');function ta(vt,bt){Tt(bt,!0);let S=q(Mt([])),C=q(!0),g=q(null),c=q("all");Et(async()=>{await $()});async function $(){l(C,!0);try{const t=await fetch("/api/alerts");if(t.ok){const s=await t.json(),h=Array.isArray(s)?s:s.alerts||[];l(S,h.map(k=>ht(k)),!0),l(g,null)}else l(g,"Failed to load alerts")}catch{l(g,"Connection error")}finally{l(C,!1)}}async function ut(){if(confirm("Clear all alerts from the log?"))try{await fetch("/api/alerts/clear",{method:"POST"}),l(S,[],!0)}catch{l(g,"Failed to clear")}}function ft(t){switch(t){case"Ka":return"badge-error";case"K":return"badge-warning";case"X":return"badge-info";case"LASER":return"badge-secondary";default:return"badge-ghost"}}function _t(t,s){return!t||s==="LASER"?"0 MHz":(t/1e3).toFixed(3)+" GHz"}function mt(t){return t?new Date(t*1e3).toLocaleTimeString():""}function gt(t){return t?new Date(t*1e3).toLocaleDateString():""}function ht(t){const s=t.band||t.Band||"",h=Number(t.freq||t.frequency||0),k=Number(t.front||t.frontStrength||0),O=Number(t.rear||t.rearStrength||0),b=Math.max(k,O),o=(t.dir||t.direction||"").toString().toUpperCase();let u=2;o==="F"||o==="FRONT"||o==="0"?u=0:(o==="R"||o==="REAR"||o==="1")&&(u=1);const R=t.utc?Number(t.utc):Math.floor(Number(t.ts||0)/1e3);return{band:s,frequency:h,strength:b,direction:u,timestamp:R}}let D=jt(()=>a(c)==="all"?a(S):a(S).filter(t=>t.band===a(c)));var E=It(),T=r(E),tt=n(r(T),2),at=r(tt);at.__click=$;var pt=n(at,2);pt.__click=ut,e(tt),e(T);var M=n(T,2),X=r(M);X.__click=()=>l(c,"all");var j=n(X,2);j.__click=()=>l(c,"Ka");var B=n(j,2);B.__click=()=>l(c,"K");var H=n(B,2);H.__click=()=>l(c,"X");var et=n(H,2);et.__click=()=>l(c,"LASER"),e(M);var xt=n(M,2);{var yt=t=>{var s=Ht();i(t,s)},At=t=>{var s=Y(),h=z(s);{var k=b=>{var o=Ot(),u=r(o),R=r(u,!0);e(u),e(o),K(()=>A(R,a(g))),i(b,o)},O=b=>{var o=Y(),u=z(o);{var R=p=>{var N=wt();i(p,N)},St=p=>{var N=Ut(),w=z(N),rt=r(w),nt=n(r(rt));ct(nt,21,()=>a(D),dt,(Rt,v)=>{var G=Pt(),P=r(G),U=r(P),Ft=r(U,!0);e(U);var ot=n(U,2),Kt=r(ot,!0);e(ot),e(P);var I=n(P),J=r(I),Lt=r(J,!0);e(J),e(I);var Q=n(I),Nt=r(Q,!0);e(Q);var V=n(Q),it=r(V);ct(it,20,()=>Array(6),dt,(d,f,F)=>{var x=Gt();K(()=>_(x,1,`w-2 h-4 rounded ${F<a(v).strength?"bg-primary":"bg-base-300"}`)),i(d,x)}),e(it),e(V);var lt=n(V),qt=r(lt);{var zt=d=>{var f=Z("‚¨ÜÔ∏è Front");i(d,f)},Ct=d=>{var f=Y(),F=z(f);{var x=y=>{var W=Z("‚¨áÔ∏è Rear");i(y,W)},Dt=y=>{var W=Z("‚ÜîÔ∏è Side");i(y,W)};L(F,y=>{a(v).direction===1?y(x):y(Dt,!1)},!0)}i(d,f)};L(qt,d=>{a(v).direction===0?d(zt):d(Ct,!1)})}e(lt),e(G),K((d,f,F,x)=>{A(Ft,d),A(Kt,f),_(J,1,`badge ${F??""}`),A(Lt,a(v).band),A(Nt,x)},[()=>mt(a(v).timestamp),()=>gt(a(v).timestamp),()=>ft(a(v).band),()=>_t(a(v).frequency,a(v).band)]),i(Rt,G)}),e(nt),e(rt),e(w);var st=n(w,2),kt=r(st);e(st),K(()=>A(kt,`Showing ${a(D).length??""} of ${a(S).length??""} alerts`)),i(p,N)};L(u,p=>{a(D).length===0?p(R):p(St,!1)},!0)}i(b,o)};L(h,b=>{a(g)?b(k):b(O,!1)},!0)}i(t,s)};L(xt,t=>{a(C)?t(yt):t(At,!1)})}e(E),K(()=>{_(X,1,`tab ${a(c)==="all"?"tab-active":""}`),_(j,1,`tab ${a(c)==="Ka"?"tab-active":""}`),_(B,1,`tab ${a(c)==="K"?"tab-active":""}`),_(H,1,`tab ${a(c)==="X"?"tab-active":""}`),_(et,1,`tab ${a(c)==="LASER"?"tab-active":""}`)}),i(vt,E),Xt()}Bt(["click"]);export{ta as component};
