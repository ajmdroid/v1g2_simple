<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>V1-Simple Installer</title>
  <style>
    :root {
      --bg: #0a0a0a;
      --card-bg: #1a1a1a;
      --accent: #22c55e;
      --accent-hover: #16a34a;
      --text: #ffffff;
      --text-muted: #a1a1aa;
      --border: #2a2a2a;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    
    .container {
      max-width: 600px;
      width: 100%;
    }
    
    .header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .logo {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent) 0%, #4ade80 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
    }
    
    .tagline {
      color: var(--text-muted);
      font-size: 1.1rem;
    }
    
    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 1.5rem;
    }
    
    .card h2 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }
    
    .steps {
      list-style: none;
      counter-reset: step;
    }
    
    .steps li {
      counter-increment: step;
      padding: 0.75rem 0;
      padding-left: 2.5rem;
      position: relative;
      color: var(--text-muted);
      border-bottom: 1px solid var(--border);
    }
    
    .steps li:last-child {
      border-bottom: none;
    }
    
    .steps li::before {
      content: counter(step);
      position: absolute;
      left: 0;
      width: 1.75rem;
      height: 1.75rem;
      background: var(--accent);
      color: var(--bg);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.875rem;
    }
    
    .install-section {
      text-align: center;
      padding: 2.5rem;
    }
    
    esp-web-install-button {
      display: inline-block;
    }
    
    esp-web-install-button button {
      background: var(--accent);
      color: var(--bg);
      border: none;
      padding: 1rem 2.5rem;
      font-size: 1.25rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
    }
    
    esp-web-install-button button:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
    }
    
    esp-web-install-button button:active {
      transform: translateY(0);
    }
    
    .version {
      margin-top: 1rem;
      color: var(--text-muted);
      font-size: 0.875rem;
    }
    
    .requirements {
      background: #1c1c1e;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
    }
    
    .requirements h3 {
      font-size: 0.875rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .requirements ul {
      list-style: none;
      font-size: 0.9rem;
      color: var(--text-muted);
    }
    
    .requirements li {
      padding: 0.25rem 0;
    }
    
    .requirements li::before {
      content: "‚Ä¢";
      color: var(--accent);
      margin-right: 0.5rem;
    }
    
    .warning {
      background: rgba(234, 179, 8, 0.1);
      border: 1px solid rgba(234, 179, 8, 0.3);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #fbbf24;
    }
    
    .footer {
      margin-top: 2rem;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.875rem;
    }
    
    .footer a {
      color: var(--accent);
      text-decoration: none;
    }
    
    .footer a:hover {
      text-decoration: underline;
    }
    
    @media (max-width: 480px) {
      body {
        padding: 1rem;
      }
      
      .card {
        padding: 1.5rem;
      }
      
      .logo {
        font-size: 2.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1 class="logo">V1-Simple</h1>
      <p class="tagline">Standalone display for Valentine One Gen2</p>
    </header>
    
    <div class="card">
      <h2>üìã Before You Begin</h2>
      <ol class="steps">
        <li>Connect your Waveshare ESP32-S3-Touch-LCD-3.49 via USB-C</li>
        <li>Use a data-capable USB cable (not charge-only)</li>
        <li>Close any serial monitors or other apps using the port</li>
        <li><strong>Put device in bootloader mode</strong> (see below)</li>
        <li>Click the Install button below and select your device</li>
      </ol>
      
      <div class="warning" style="background: rgba(59, 130, 246, 0.15); border-color: rgba(59, 130, 246, 0.4); color: #60a5fa; margin-top: 1rem;">
        <strong>‚ö° IMPORTANT: Bootloader Mode Required</strong>
        <div style="margin-top: 0.75rem; font-size: 0.95rem;">
          <strong style="color: #fbbf24;">üîã If using battery power:</strong><br>
          <span style="opacity: 0.9;">Disconnect battery first, then hold BOOT while plugging in USB</span>
        </div>
        <div style="margin-top: 0.75rem; font-size: 1rem;">
          <strong>USB only:</strong><br>
          1. <strong>Hold BOOT button</strong> (small button on back)<br>
          2. While holding BOOT, <strong>press RESET button</strong><br>
          3. <strong>Release BOOT</strong> after pressing RESET
        </div>
        <div style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.8;">
          ‚úì The screen will stay blank ‚Äî this is normal!
        </div>
      </div>
      
      <div class="requirements">
        <h3>Requirements</h3>
        <ul>
          <li>Chrome, Edge, or Opera browser (Firefox not supported)</li>
          <li>Waveshare ESP32-S3-Touch-LCD-3.49</li>
          <li>USB-C data cable</li>
        </ul>
      </div>
    </div>
    
    <div class="card install-section">
      <esp-web-install-button manifest="manifest.json">
        <button slot="activate">Install V1-Simple</button>
        <span slot="unsupported">
          <p style="color: #ef4444;">Your browser doesn't support Web Serial.</p>
          <p style="color: var(--text-muted); margin-top: 0.5rem;">Please use Chrome, Edge, or Opera.</p>
        </span>
        <span slot="not-allowed">
          <p style="color: #ef4444;">Serial access not allowed.</p>
          <p style="color: var(--text-muted); margin-top: 0.5rem;">Make sure you're on HTTPS and have granted permission.</p>
        </span>
      </esp-web-install-button>
      <p class="version">Version: <span id="version">loading...</span></p>
      
      <div class="warning">
        ‚ö†Ô∏è Install takes ~60 seconds. Don't disconnect!
      </div>
      <div class="warning" style="background: rgba(34, 197, 94, 0.1); border-color: rgba(34, 197, 94, 0.3); color: #22c55e; margin-top: 0.5rem;">
        ‚úÖ When complete, <strong>press the RESET button</strong> on your device to boot.
      </div>
    </div>
    
    <div class="card">
      <h2>üöÄ After Installation</h2>
      <ol class="steps">
        <li><strong>Press RESET button</strong> on the device to boot the firmware</li>
        <li>Device will show the "SCAN" animation</li>
        <li>Connect to WiFi: <strong>V1-Simple</strong> (password: <strong>setupv1g2</strong>)</li>
        <li>Open <strong>http://192.168.35.5</strong> to configure</li>
        <li>Pair with your V1 Gen2 via the Devices page</li>
      </ol>
    </div>
    
    <footer class="footer">
      <p>
        <a href="https://github.com/ajmdroid/v1g2_simple">GitHub</a> ¬∑ 
        <a href="https://github.com/ajmdroid/v1g2_simple/blob/main/docs/MANUAL.md">Documentation</a> ¬∑ 
        <a href="https://github.com/ajmdroid/v1g2_simple/releases">All Releases</a>
      </p>
    </footer>
  </div>
  
  <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
  <script>
    // Fetch version from manifest
    fetch('manifest.json')
      .then(r => r.json())
      .then(data => {
        document.getElementById('version').textContent = data.version || 'unknown';
      })
      .catch(() => {
        document.getElementById('version').textContent = 'unknown';
      });
  </script>
</body>
</html>
